<!-- Creates a layout with a left-positioned sidenav and explicit content. -->
<mat-sidenav-container>
  <mat-sidenav mode="side" role="navigation" opened>
    <mat-toolbar
      color="primary"
      class="sidenav-toolbar"
      style="justify-content: center"
    >
      <mat-icon>menu</mat-icon>&nbsp;Angular Material Sidenav
    </mat-toolbar>
    <mat-nav-list>
      <a
        mat-list-item
        routerLinkActive="active-button"
        [routerLinkActiveOptions]="{ exact: true }"
        routerLink="/home"
        >Die Marktseite</a
      >
      <a
        mat-list-item
        routerLinkActive="active-button"
        [routerLinkActiveOptions]="{ exact: true }"
        routerLink="/step1"
        >Schritt 1 - nur ein Request - anzeige als JSON</a
      >
      <a
        mat-list-item
        routerLinkActive="active-button"
        [routerLinkActiveOptions]="{ exact: true }"
        routerLink="/step2"
        >Schritt 2 - nur ein Request - response als String</a
      >
      <a
        mat-list-item
        routerLinkActive="active-button"
        [routerLinkActiveOptions]="{ exact: true }"
        routerLink="/step3"
        >Schritt 3- Asynchron Handling (JSON Output)
      </a>
      <a
        mat-list-item
        routerLinkActive="active-button"
        [routerLinkActiveOptions]="{ exact: true }"
        routerLink="/step4"
        >Schritt 4 - Asynchron Handling (Formular-Output)</a
      >
    </mat-nav-list>
    <div class="spacer"></div>
    <!-- User + Logout unten -->
    <div
      class="user-section"
      style="padding: 16px 8px 8px 8px; margin-top: auto"
    >
      <mat-divider></mat-divider>
      <div
        class="user-info"
        style="display: flex; align-items: center; gap: 12px; margin-top: 12px"
      >
        <mat-icon color="primary">account_circle</mat-icon>
        <div>
          <div style="font-size: 13px; color: gray">Angemeldet als</div>
          <div style="font-size: 16px; font-weight: bold">{{ username }}</div>
        </div>
      </div>
      <!-- TOKEN-FELD: Wächst maximal im Bereich -->
      <div class="token-box"
           style="
            flex: 1 1 auto;
            min-height: 0;
            margin-bottom: 12px;
            display: flex;
            flex-direction: column;
           ">
        <div style="font-size: 13px; color: gray; display: flex; align-items: center; margin-bottom: 3px;">
          <mat-icon style="margin-right: 4px;">vpn_key</mat-icon>
          Token:
          <button mat-icon-button (click)="copyToken(token)" [matTooltip]="'Token kopieren'" style="margin-left: auto;">
            <mat-icon>content_copy</mat-icon>
          </button>
        </div>
        <div style="
          font-family: monospace;
          font-size: 11px;
          color: #2e2e2e;
          word-break: break-all;
          background: #f7f7f7;
          border-radius: 6px;
          padding: 8px 8px 8px 12px;
          flex: 1 1 auto;
          min-height: 0;
          overflow: auto;            
          white-space: pre;   /* <- WICHTIG: Zeilenumbrüche bleiben erhalten! */
 ">
          {{ token }}
        </div>
      </div>
      <button
        mat-stroked-button
        color="warn"
        style="margin-top: 18px; width: 100%"
        (click)="logout()"
      >
        <mat-icon>logout</mat-icon>&nbsp;Logout
      </button>
    </div>
  </mat-sidenav>
  <mat-sidenav-content>
    <h1>مرحبا بكم في السوق</h1>
    <p>ًWillkommen auf dem Markt</p>
    <router-outlet />
  </mat-sidenav-content>
</mat-sidenav-container>
